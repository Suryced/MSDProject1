{"ast":null,"code":"import RestAPI from'../rest';var initial={username:\"\",password:\"\",mode:\"login\",loginstate:\"initial\"};var savedState=sessionStorage.getItem('loginState');if(savedState!=null){initial=Object.assign({},initial,JSON.parse(savedState));}var appState=function appState(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initial;var action=arguments.length>1?arguments[1]:undefined;var data=arguments.length>2?arguments[2]:undefined;console.log(\"in reducer login\");switch(action.type){case'SET_REGISTRATION_MODE':{var mode={\"mode\":'register'};var fields={\"username\":\"\",\"email\":\"\",\"password\":\"\"};var new_state=Object.assign({},state,mode,fields);return new_state;}case'REGISTER_USER':{console.log(\"login.REGISTER_USER: \");new RestAPI().registerUser(action.dispatch,action.username,action.password,action.email);var _mode={\"mode\":'login'};var _new_state=Object.assign({},state,_mode);return _new_state;}case'LOGIN_TO_APP':{var newState={username:action.username,password:action.password,loginstate:action.loginstate,mode:'login'};console.log(\"in LOGIN_TO_APP\");console.log(\"login.LOGIN_TO_APP: \"+JSON.stringify(newState));new RestAPI().getJWTToken(action.dispatch,action.username,action.password);sessionStorage.setItem('loginState',JSON.stringify(newState));return Object.assign({},newState);}case'GET_JWT_TOKEN':{new RestAPI().getJWTToken(action.dispatch,action.username,action.password);break;}case'LOG_OUT':{var _newState={username:'none',password:'',loginstate:'logged-out',mode:'login'};console.log(\"in LOG_OUT\");console.log(\"login.LOG_OUT: \"+JSON.stringify(_newState));window['token']=null;return Object.assign({},_newState);}case'LOGIN_SUCCESS':{// update state with token and login status\nvar loginstate='logged-in';var token=action.token;var obj=Object.assign({},state,{loginstate:loginstate,\"token\":token});window['token']=token;return obj;}case'LOGIN_FAILED':{// update state with token and login status\nalert(\"login failed!\");var _loginstate='login-failed';var _token=\"\";var _mode2=\"login\";var _obj=Object.assign({},state,{loginstate:_loginstate,token:_token,mode:_mode2});return _obj;}case'UPDATE_LOGIN_FORM_OBJECT':{console.log(\"in reducer login.UPDATE_LOGIN_FORM_OBJECT\");var field={};field[action.field_name]=action.field_value;var _obj2=Object.assign({},state,field);console.log(\"login.UPDATE_LOGIN_FORM_OBJECT: \"+JSON.stringify(_obj2));return _obj2;}default:return state;}};export default appState;","map":{"version":3,"names":["RestAPI","initial","username","password","mode","loginstate","savedState","sessionStorage","getItem","Object","assign","JSON","parse","appState","state","arguments","length","undefined","action","data","console","log","type","fields","new_state","registerUser","dispatch","email","newState","stringify","getJWTToken","setItem","window","token","obj","alert","field","field_name","field_value"],"sources":["/home/wasadmin/LabFiles/MsdProject/projectday2/project-react-client-crud (copy)/src/reducers/login.js"],"sourcesContent":["import RestAPI from '../rest';\nlet initial = {username:\"\", password:\"\", mode: \"login\", loginstate: \"initial\" };\nconst savedState = sessionStorage.getItem('loginState');\nif(savedState != null){\n    initial = Object.assign({}, initial, JSON.parse(savedState));\n}\n\n\nconst appState = (state = initial, action, data) => {\n    console.log(\"in reducer login\");\n\n    switch (action.type) {\n\n    case 'SET_REGISTRATION_MODE':{\n        let mode = {\"mode\":'register'};\n        let fields = {\"username\":\"\", \"email\": \"\", \"password\": \"\"};\n        let new_state = Object.assign({}, state, mode, fields);\n        return new_state;\n    }\n\n    case 'REGISTER_USER': {\n        console.log( \"login.REGISTER_USER: \");\n        new RestAPI().registerUser(action.dispatch, action.username, action.password, action.email);\n        let mode = {\"mode\":'login'};\n        let new_state = Object.assign({}, state, mode);\n        return new_state;    \n    }\n\n    case 'LOGIN_TO_APP': {\n        let newState = {username: action.username, password:action.password, loginstate: action.loginstate, mode: 'login' };\n        console.log(\"in LOGIN_TO_APP\");\n        console.log( \"login.LOGIN_TO_APP: \" + JSON.stringify(newState));\n        new RestAPI().getJWTToken(action.dispatch, action.username, action.password);\n        sessionStorage.setItem('loginState', JSON.stringify(newState));\n        return  Object.assign({}, newState);\n    } \n    case 'GET_JWT_TOKEN':{\n        new RestAPI().getJWTToken(action.dispatch, action.username, action.password);\n        break;\n    }\n\n    case 'LOG_OUT': {\n        let newState = {username: 'none', password:'', loginstate: 'logged-out', mode: 'login' };\n        console.log(\"in LOG_OUT\");\n        console.log( \"login.LOG_OUT: \" + JSON.stringify(newState));\n        window['token'] = null;\n        return  Object.assign({}, newState);       \n    }\n\n    case 'LOGIN_SUCCESS': {\n        // update state with token and login status\n        let loginstate = 'logged-in';\n        let token = action.token;\n        const obj = Object.assign({}, state, { loginstate, \"token\":token });\n        window['token'] = token;\n        return obj;        \n    }\n    case 'LOGIN_FAILED': {\n        // update state with token and login status\n        alert(\"login failed!\");\n        let loginstate = 'login-failed';\n        let token = \"\";\n        let mode = \"login\";\n        const obj = Object.assign({}, state, { loginstate, token, mode });\n        return obj;       \n    }\n\n    case 'UPDATE_LOGIN_FORM_OBJECT': {\n        console.log(\"in reducer login.UPDATE_LOGIN_FORM_OBJECT\");\n        let field = {};\n        field[action.field_name] = action.field_value;\n        const obj = Object.assign({}, state, field);\n        console.log( \"login.UPDATE_LOGIN_FORM_OBJECT: \" + JSON.stringify(obj));\n        return obj;\n      }\n    default:\n        return state\n    }\n}\n\nexport default appState"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}